<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gulp Build Guide - MediaHub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 0;
            margin-bottom: 40px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .back-link {
            display: inline-block;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            transition: background 0.3s ease;
            font-weight: 500;
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .content {
            background: white;
            border-radius: 8px;
            padding: 40px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        h2 {
            color: #667eea;
            font-size: 2rem;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        h2:first-child {
            margin-top: 0;
        }

        h3 {
            color: #764ba2;
            font-size: 1.5rem;
            margin: 30px 0 15px 0;
        }

        h4 {
            color: #555;
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        p {
            margin-bottom: 15px;
            color: #555;
        }

        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin-bottom: 8px;
            color: #555;
        }

        strong {
            color: #333;
            font-weight: 600;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "SF Mono", Monaco, "Courier New", monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        pre {
            background: #1f2937;
            color: #e5e7eb;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: "SF Mono", Monaco, "Courier New", monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
            font-size: inherit;
        }

        .card {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .card.success {
            border-left-color: #10b981;
            background: #f0fdf4;
        }

        .card.warning {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }

        .card.info {
            border-left-color: #3b82f6;
            background: #eff6ff;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:nth-child(even) {
            background: #f9fafb;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .grid-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .grid-item h4 {
            margin-top: 0;
            color: #667eea;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            background: #667eea;
            color: white;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-left: 8px;
        }

        .badge.optional {
            background: #10b981;
        }

        .badge.required {
            background: #ef4444;
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: #6b7280;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 20px;
            }

            header .container {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div>
                <h1>Gulp Build Guide</h1>
                <p>Complete guide to building MediaHub with Gulp 4</p>
            </div>
            <a href="README.md" class="back-link">‚Üê Back to README</a>
        </div>
    </header>

    <div class="container">
        <div class="content">
            <h2>Overview</h2>
            <p>MediaHub uses Gulp 4 with Rollup for building JavaScript modules and Sass for stylesheets. The build system supports both development and production modes with separate bundles for core components and optional features.</p>

            <div class="card info">
                <strong>Key Benefit:</strong> By separating ConfigBuilder into its own bundle, the main library is <strong>50% smaller</strong> (~454KB vs ~905KB), resulting in faster page loads for users who don't need the ConfigBuilder tool.
            </div>

            <h2>Build Architecture</h2>
            <p>The project is structured to generate multiple bundles:</p>

            <h3>Core Bundles <span class="badge required">Always Built</span></h3>
            <ul>
                <li><code>media-hub.js</code> / <code>media-hub.iife.js</code> - Main library (FileUploader, FileCarousel, MediaCapture)</li>
                <li><code>media-hub.css</code> - Core component styles</li>
                <li><code>main.js</code> / <code>main.iife.js</code> - Demo application scripts</li>
                <li><code>main.css</code> - Demo application styles</li>
                <li><code>bootstrap_*.js</code> / <code>bootstrap_*.iife.js</code> - Bootstrap integration scripts (versions 3, 4, 5)</li>
            </ul>

            <h3>Optional Bundles <span class="badge optional">with-config-builder task</span></h3>
            <ul>
                <li><code>config-builder.js</code> / <code>config-builder.iife.js</code> - ConfigBuilder component</li>
                <li><code>config-builder.css</code> - ConfigBuilder styles</li>
            </ul>

            <h2>Available Build Tasks</h2>

            <div class="grid">
                <div class="grid-item">
                    <h4>Development Build</h4>
                    <pre><code>npm run dev</code></pre>
                    <p><strong>What it does:</strong></p>
                    <ul>
                        <li>Builds core bundles only</li>
                        <li>Excludes ConfigBuilder</li>
                        <li>Generates source maps</li>
                        <li>Watches for changes</li>
                        <li>No minification</li>
                    </ul>
                    <p><strong>Size:</strong> ~454KB JS, ~130KB CSS</p>
                </div>

                <div class="grid-item">
                    <h4>Production Build</h4>
                    <pre><code>npm run prod</code></pre>
                    <p><strong>What it does:</strong></p>
                    <ul>
                        <li>Builds core bundles only</li>
                        <li>Minifies & obfuscates JS</li>
                        <li>Minifies CSS</li>
                        <li>File hashing for cache busting</li>
                        <li>Creates manifest files</li>
                    </ul>
                    <p><strong>Size:</strong> ~210KB JS, ~60KB CSS</p>
                </div>

                <div class="grid-item">
                    <h4>Dev with ConfigBuilder</h4>
                    <pre><code>npm run with-config-builder</code></pre>
                    <p><strong>What it does:</strong></p>
                    <ul>
                        <li>Builds all bundles</li>
                        <li>Includes ConfigBuilder</li>
                        <li>Source maps enabled</li>
                        <li>Watches all files</li>
                        <li>No minification</li>
                    </ul>
                    <p><strong>Size:</strong> ~454KB + ~870KB ConfigBuilder</p>
                </div>

                <div class="grid-item">
                    <h4>Prod with ConfigBuilder</h4>
                    <pre><code>npm run with-config-builder:prod</code></pre>
                    <p><strong>What it does:</strong></p>
                    <ul>
                        <li>Builds all bundles</li>
                        <li>Includes ConfigBuilder</li>
                        <li>Full minification</li>
                        <li>File hashing enabled</li>
                        <li>Complete manifests</li>
                    </ul>
                    <p><strong>Size:</strong> ~210KB + ~400KB ConfigBuilder</p>
                </div>
            </div>

            <h3>Clean Task</h3>
            <pre><code>npm run clean</code></pre>
            <p>Removes all generated files from the <code>dist/</code> directory.</p>

            <h2>Bundle Formats</h2>
            <p>All JavaScript bundles are generated in two formats for maximum browser compatibility:</p>

            <h3>1. ESM (ES Modules) - <code>filename.js</code></h3>
            <ul>
                <li>Modern module format using <code>import/export</code></li>
                <li>Used by modern browsers with <code>&lt;script type="module"&gt;</code></li>
                <li>Tree-shakeable and optimized</li>
            </ul>

            <h3>2. IIFE (Immediately Invoked Function Expression) - <code>filename.iife.js</code></h3>
            <ul>
                <li>Classic script format for older browsers</li>
                <li>Used with <code>&lt;script nomodule&gt;</code></li>
                <li>Exposes globals: <code>window.FileUploader</code>, <code>window.FileCarousel</code>, etc.</li>
            </ul>

            <h2>HTML Integration</h2>

            <h3>Using Core Library Only</h3>
            <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" href="dist/css/media-hub-abc123.css"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="uploader"&gt;&lt;/div&gt;

  &lt;!-- Modern browsers --&gt;
  &lt;script type="module" src="dist/js/media-hub-abc123.js"&gt;&lt;/script&gt;

  &lt;!-- Fallback for older browsers --&gt;
  &lt;script nomodule src="dist/js/media-hub-abc123.iife.js"&gt;&lt;/script&gt;

  &lt;script type="module"&gt;
    import { FileUploader } from './dist/js/media-hub-abc123.js';
    const uploader = new FileUploader('#uploader');
  &lt;/script&gt;

  &lt;script nomodule&gt;
    // For older browsers using IIFE
    const uploader = new FileUploader('#uploader');
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

            <h3>Using ConfigBuilder</h3>
            <p>When you need the ConfigBuilder component, include both bundles:</p>
            <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;!-- Core styles --&gt;
  &lt;link rel="stylesheet" href="dist/css/media-hub-abc123.css"&gt;

  &lt;!-- ConfigBuilder styles --&gt;
  &lt;link rel="stylesheet" href="dist/css/config-builder-def456.css"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="config-builder"&gt;&lt;/div&gt;

  &lt;!-- Core library --&gt;
  &lt;script type="module" src="dist/js/media-hub-abc123.js"&gt;&lt;/script&gt;
  &lt;script nomodule src="dist/js/media-hub-abc123.iife.js"&gt;&lt;/script&gt;

  &lt;!-- ConfigBuilder --&gt;
  &lt;script type="module" src="dist/js/config-builder-def456.js"&gt;&lt;/script&gt;
  &lt;script nomodule src="dist/js/config-builder-def456.iife.js"&gt;&lt;/script&gt;

  &lt;script type="module"&gt;
    import ConfigBuilder from './dist/js/config-builder-def456.js';
    const builder = new ConfigBuilder('#config-builder');
  &lt;/script&gt;

  &lt;script nomodule&gt;
    // For older browsers using IIFE
    const builder = new ConfigBuilder('#config-builder');
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

            <h2>Manifest Files</h2>
            <p>In production builds, the build system generates manifest JSON files that map original filenames to their hashed versions:</p>

            <div class="card">
                <strong>Location:</strong> <code>dist/manifests/</code>
                <ul>
                    <li><code>css-manifest.json</code> - CSS file mappings</li>
                    <li><code>js-manifest.json</code> - JavaScript file mappings</li>
                </ul>
            </div>

            <h3>Example Manifest</h3>
            <pre><code>{
  "media-hub.css": "media-hub-abc123.css",
  "media-hub.js": "media-hub-abc123.js",
  "config-builder.css": "config-builder-def456.css",
  "config-builder.js": "config-builder-def456.js"
}</code></pre>

            <h3>Usage in PHP</h3>
            <pre><code>&lt;?php
$manifest = json_decode(file_get_contents('dist/manifests/js-manifest.json'), true);
$mediaHubJs = $manifest['media-hub.js'] ?? 'media-hub.js';
?&gt;
&lt;script type="module" src="dist/js/&lt;?= $mediaHubJs ?&gt;"&gt;&lt;/script&gt;</code></pre>

            <h2>Build Configuration</h2>
            <p>The build system is configured in <code>Gulpfile.js</code>. Key configuration:</p>

            <h3>Source Directories</h3>
            <ul>
                <li><strong>Library JS:</strong> <code>src/library/js/</code></li>
                <li><strong>Library SCSS:</strong> <code>src/library/scss/</code></li>
                <li><strong>Assets JS:</strong> <code>src/assets/js/</code></li>
                <li><strong>Assets SCSS:</strong> <code>src/assets/scss/</code></li>
            </ul>

            <h3>Output Directory</h3>
            <ul>
                <li><strong>Base:</strong> <code>dist/</code></li>
                <li><strong>JavaScript:</strong> <code>dist/js/</code></li>
                <li><strong>CSS:</strong> <code>dist/css/</code></li>
                <li><strong>Manifests:</strong> <code>dist/manifests/</code></li>
            </ul>

            <h3>Entry Points</h3>
            <table>
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Output</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>src/library/js/index.js</code></td>
                        <td><code>media-hub.js</code></td>
                        <td>Core library bundle</td>
                    </tr>
                    <tr>
                        <td><code>src/library/js/config-builder.js</code></td>
                        <td><code>config-builder.js</code></td>
                        <td>ConfigBuilder bundle</td>
                    </tr>
                    <tr>
                        <td><code>src/library/scss/index.scss</code></td>
                        <td><code>media-hub.css</code></td>
                        <td>Core styles</td>
                    </tr>
                    <tr>
                        <td><code>src/library/scss/config-builder.scss</code></td>
                        <td><code>config-builder.css</code></td>
                        <td>ConfigBuilder styles</td>
                    </tr>
                </tbody>
            </table>

            <h2>Why Separate ConfigBuilder?</h2>
            <p>ConfigBuilder is an optional development tool that:</p>
            <ul>
                <li>Generates configuration code for FileUploader</li>
                <li>Provides a visual interface for setting options</li>
                <li>Is primarily used by developers, not end-users</li>
                <li>Adds ~870KB to the bundle size</li>
            </ul>

            <div class="card success">
                <h4>Benefits of Separation:</h4>
                <ul>
                    <li><strong>50% smaller default bundle:</strong> Main library is ~454KB vs ~905KB</li>
                    <li><strong>Faster development:</strong> Regular builds complete faster without ConfigBuilder</li>
                    <li><strong>Selective loading:</strong> Only include ConfigBuilder when needed</li>
                    <li><strong>Better caching:</strong> Users only download ConfigBuilder once</li>
                    <li><strong>Cleaner separation:</strong> Core functionality vs development tools</li>
                </ul>
            </div>

            <h2>File Watching</h2>
            <p>In development mode (<code>npm run dev</code> or <code>npm run with-config-builder</code>), the build system watches for file changes:</p>

            <h3>When ConfigBuilder is excluded (<code>npm run dev</code>)</h3>
            <ul>
                <li>Watches: <code>src/library/js/**/*.js</code> (excluding ConfigBuilder files)</li>
                <li>Watches: <code>src/library/scss/**/*.scss</code> (excluding ConfigBuilder styles)</li>
                <li>Watches: <code>src/assets/**/*.{js,scss}</code></li>
            </ul>

            <h3>When ConfigBuilder is included (<code>npm run with-config-builder</code>)</h3>
            <ul>
                <li>Watches: <code>src/library/js/**/*.js</code> (including ConfigBuilder files)</li>
                <li>Watches: <code>src/library/scss/**/*.scss</code> (including ConfigBuilder styles)</li>
                <li>Watches: <code>src/assets/**/*.{js,scss}</code></li>
            </ul>

            <h2>Build Tools</h2>
            <p>The build system uses the following tools:</p>
            <ul>
                <li><strong>Gulp 4:</strong> Task automation with async/await support</li>
                <li><strong>Rollup:</strong> JavaScript module bundler with tree-shaking</li>
                <li><strong>Babel:</strong> Transpiles modern JavaScript to ES5 for older browsers</li>
                <li><strong>Sass/SCSS:</strong> CSS preprocessor with <code>@use</code> modules</li>
                <li><strong>PostCSS:</strong> CSS transformations and autoprefixer</li>
                <li><strong>uglify-es:</strong> JavaScript minification</li>
                <li><strong>javascript-obfuscator:</strong> Code obfuscation for production</li>
                <li><strong>clean-css:</strong> CSS minification</li>
                <li><strong>gulp-rev:</strong> File hashing for cache busting</li>
            </ul>

            <h2>Performance Comparison</h2>
            <table>
                <thead>
                    <tr>
                        <th>Build Mode</th>
                        <th>media-hub.js</th>
                        <th>config-builder.js</th>
                        <th>Total JS</th>
                        <th>Build Time</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Dev (core only)</td>
                        <td>454KB</td>
                        <td>-</td>
                        <td>454KB</td>
                        <td>~8s</td>
                    </tr>
                    <tr>
                        <td>Dev (with ConfigBuilder)</td>
                        <td>454KB</td>
                        <td>870KB</td>
                        <td>1,324KB</td>
                        <td>~12s</td>
                    </tr>
                    <tr>
                        <td>Prod (core only)</td>
                        <td>210KB</td>
                        <td>-</td>
                        <td>210KB</td>
                        <td>~15s</td>
                    </tr>
                    <tr>
                        <td>Prod (with ConfigBuilder)</td>
                        <td>210KB</td>
                        <td>400KB</td>
                        <td>610KB</td>
                        <td>~20s</td>
                    </tr>
                </tbody>
            </table>

            <h2>Troubleshooting</h2>

            <div class="card warning">
                <h4>Build fails with SCSS errors</h4>
                <ul>
                    <li>Ensure you're using <code>@use</code> instead of <code>@import</code> for Sass modules</li>
                    <li>Check for duplicate variable definitions across modules</li>
                </ul>
            </div>

            <div class="card warning">
                <h4>JavaScript bundle is too large</h4>
                <ul>
                    <li>Use <code>npm run prod</code> to enable minification and obfuscation</li>
                    <li>Exclude ConfigBuilder unless needed: <code>npm run dev</code> instead of <code>npm run with-config-builder</code></li>
                </ul>
            </div>

            <div class="card warning">
                <h4>File changes not being detected</h4>
                <ul>
                    <li>Ensure you're running in watch mode: <code>npm run dev</code> or <code>npm run with-config-builder</code></li>
                    <li>Check that the file is not in an excluded pattern</li>
                    <li>Restart the watch task if needed</li>
                </ul>
            </div>

            <div class="card warning">
                <h4>Manifest files not generated</h4>
                <ul>
                    <li>Manifests are only created in production builds (<code>npm run prod</code> or <code>npm run with-config-builder:prod</code>)</li>
                    <li>Check <code>dist/manifests/</code> directory after production build</li>
                </ul>
            </div>

            <h2>Development Workflow</h2>

            <h3>Regular feature development (no ConfigBuilder needed)</h3>
            <pre><code>npm run dev
# Edit files in src/
# Changes automatically rebuild</code></pre>

            <h3>Working on ConfigBuilder or using it</h3>
            <pre><code>npm run with-config-builder
# Edit files including ConfigBuilder
# Changes automatically rebuild</code></pre>

            <h3>Preparing for deployment</h3>
            <pre><code>npm run prod
# Or with ConfigBuilder if needed:
npm run with-config-builder:prod
# Upload dist/ directory to server</code></pre>

            <h2>CI/CD Integration</h2>
            <p>For automated builds in CI/CD pipelines:</p>
            <pre><code># Install dependencies
npm install

# Production build (core only)
npm run prod

# Or with ConfigBuilder
npm run with-config-builder:prod

# Outputs will be in dist/ directory</code></pre>

            <div class="card info">
                <strong>Pro Tip:</strong> In CI/CD, always use production builds (<code>npm run prod</code>) for deployment. Development builds include source maps and are significantly larger.
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2024 MediaHub - Free to use for personal and commercial projects</p>
            <p><a href="README.md" style="color: #667eea; text-decoration: none;">Back to README</a></p>
        </div>
    </footer>
</body>
</html>
